--- template-spreadsheets/handlebars/content.xml	2023-09-27 18:15:26
+++ template-spreadsheets/handlebars/content.xml	2023-09-27 21:15:33
@@ -87,24 +87,18 @@
             <text:p>b</text:p>
           </table:table-cell>
         </table:table-row>
+{{#each sheets}}
         <table:table-row table:style-name="ro2">
           <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>Age</text:p>
+            <text:p>{{sheetName}}</text:p>
           </table:table-cell>
           <table:table-cell office:value-type="string" calcext:value-type="string">
             <text:p>
-              <text:a xlink:href="#Age" xlink:type="simple">Age</text:a>
+              <text:a xlink:href="#{{sheetName}}" xlink:type="simple">{{sheetName}}</text:a>
             </text:p>
           </table:table-cell>
         </table:table-row>
-        <table:table-row table:style-name="ro2">
-          <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>y</text:p>
-          </table:table-cell>
-          <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>more text</text:p>
-          </table:table-cell>
-        </table:table-row>
+{{/each}}
         <table:table-row table:style-name="ro2" table:number-rows-repeated="1048570">
           <table:table-cell table:number-columns-repeated="2"/>
         </table:table-row>
@@ -112,11 +106,12 @@
           <table:table-cell table:number-columns-repeated="2"/>
         </table:table-row>
       </table:table>
-      <table:table table:name="Age" table:style-name="ta1">
+{{#each sheets}}
+      <table:table table:name="{{sheetName}}" table:style-name="ta1">
         <table:table-column table:style-name="co1" table:number-columns-repeated="3" table:default-cell-style-name="Default"/>
         <table:table-row table:style-name="ro1">
           <table:table-cell table:style-name="Heading_20_1" office:value-type="string" calcext:value-type="string">
-            <text:p>Age title</text:p>
+            <text:p>{{sheetName}} (generated title)</text:p>
           </table:table-cell>
           <table:table-cell table:number-columns-repeated="2"/>
         </table:table-row>
@@ -124,49 +119,24 @@
           <table:table-cell table:number-columns-repeated="3"/>
         </table:table-row>
         <table:table-row table:style-name="ro2">
+{{#each ../tableHeadings}}
           <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>a</text:p>
+            <text:p>{{this}}</text:p>
           </table:table-cell>
-          <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>b</text:p>
-          </table:table-cell>
-          <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>c</text:p>
-          </table:table-cell>
+{{/each}}
         </table:table-row>
+{{#each rowData}}
         <table:table-row table:style-name="ro2">
           <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>x</text:p>
+            <text:p>{{name}}</text:p>
           </table:table-cell>
-          <table:table-cell table:style-name="ce3" office:value-type="float" office:value="1" calcext:value-type="float">
-            <text:p>1.0</text:p>
+{{#each values}}
+          <table:table-cell table:style-name="ce3" office:value-type="float" office:value="{{this}}" calcext:value-type="float">
+            <text:p>{{this}}</text:p>
           </table:table-cell>
-          <table:table-cell table:style-name="ce3" office:value-type="float" office:value="2" calcext:value-type="float">
-            <text:p>2.0</text:p>
-          </table:table-cell>
+{{/each}}
         </table:table-row>
-        <table:table-row table:style-name="ro2">
-          <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>y</text:p>
-          </table:table-cell>
-          <table:table-cell table:style-name="ce3" office:value-type="float" office:value="3" calcext:value-type="float">
-            <text:p>3.0</text:p>
-          </table:table-cell>
-          <table:table-cell table:style-name="ce3" office:value-type="float" office:value="4" calcext:value-type="float">
-            <text:p>4.0</text:p>
-          </table:table-cell>
-        </table:table-row>
-        <table:table-row table:style-name="ro2">
-          <table:table-cell office:value-type="string" calcext:value-type="string">
-            <text:p>z</text:p>
-          </table:table-cell>
-          <table:table-cell table:style-name="ce3" office:value-type="float" office:value="5" calcext:value-type="float">
-            <text:p>5.0</text:p>
-          </table:table-cell>
-          <table:table-cell table:style-name="ce3" office:value-type="float" office:value="6" calcext:value-type="float">
-            <text:p>6.0</text:p>
-          </table:table-cell>
-        </table:table-row>
+{{/each}}
         <table:table-row table:style-name="ro2" table:number-rows-repeated="1048569">
           <table:table-cell table:number-columns-repeated="3"/>
         </table:table-row>
@@ -174,9 +144,13 @@
           <table:table-cell table:number-columns-repeated="3"/>
         </table:table-row>
       </table:table>
+{{/each}}
       <table:named-expressions/>
       <table:database-ranges>
         <table:database-range table:name="here_is_a_table" table:target-range-address="'Cover sheet'.A3:'Cover sheet'.B5" table:on-update-keep-styles="true" table:on-update-keep-size="false" table:orientation="column"/>
+{{#each sheets}}
+        <table:database-range table:name="{{tableName}}" table:target-range-address="'{{sheetName}}'.{{firstTableCell}}:'{{sheetName}}'.{{lastTableCell}}" table:on-update-keep-styles="true" table:on-update-keep-size="false" table:orientation="column"/>
+{{/each}}
       </table:database-ranges>
     </office:spreadsheet>
   </office:body>
--- template-spreadsheets/handlebars/meta.xml	2023-09-27 18:15:26
+++ template-spreadsheets/handlebars/meta.xml	2023-09-27 18:18:59
@@ -6,6 +6,6 @@
     <meta:editing-duration>PT6M16S</meta:editing-duration>
     <meta:editing-cycles>7</meta:editing-cycles>
     <meta:generator>LibreOffice/7.0.6.2$MacOSX_X86_64 LibreOffice_project/144abb84a525d8e30c9dbbefa69cbbf2d8d4ae3b</meta:generator>
-    <meta:document-statistic meta:table-count="3" meta:cell-count="27" meta:object-count="0"/>
+    <meta:document-statistic meta:table-count="{{tableCount}}" meta:object-count="0"/>
   </office:meta>
 </office:document-meta>
--- template-spreadsheets/handlebars/settings.xml	2023-09-27 18:15:26
+++ template-spreadsheets/handlebars/settings.xml	2023-09-27 18:18:59
@@ -10,7 +10,8 @@
         <config:config-item-map-entry>
           <config:config-item config:name="ViewId" config:type="string">view1</config:config-item>
           <config:config-item-map-named config:name="Tables">
-            <config:config-item-map-entry config:name="Age">
+{{#each sheets}}
+            <config:config-item-map-entry config:name="{{this.sheetName}}">
               <config:config-item config:name="CursorPositionX" config:type="int">0</config:config-item>
               <config:config-item config:name="CursorPositionY" config:type="int">0</config:config-item>
               <config:config-item config:name="HorizontalSplitMode" config:type="short">0</config:config-item>
@@ -28,6 +29,7 @@
               <config:config-item config:name="ShowGrid" config:type="boolean">true</config:config-item>
               <config:config-item config:name="AnchoredTextOverflowLegacy" config:type="boolean">false</config:config-item>
             </config:config-item-map-entry>
+{{/each}}
             <config:config-item-map-entry config:name="Contents">
               <config:config-item config:name="CursorPositionX" config:type="int">0</config:config-item>
               <config:config-item config:name="CursorPositionY" config:type="int">0</config:config-item>
